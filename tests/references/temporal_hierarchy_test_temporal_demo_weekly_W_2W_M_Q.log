INFO:pyaf.std:START_HIERARCHICAL_PLOTTING
INFO:pyaf.std:END_HIERARCHICAL_PLOTTING_TIME_IN_SECONDS 2.5749709606170654
INFO:pyaf.std:START_HIERARCHICAL_TRAINING
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_TEMPORAL_FREQUENCIES {'W': 604800.0, '2W': 1209600.0, 'M': 2419200.0, 'Q': 7862400.0}
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_TEMPORAL_HORIZONS_FIRST_RESAMPLED_DATA W {'TH_W_start': {0: Timestamp('2001-01-28 00:00:00'), 1: Timestamp('2001-02-04 00:00:00'), 2: Timestamp('2001-02-11 00:00:00'), 3: Timestamp('2001-02-18 00:00:00'), 4: Timestamp('2001-02-25 00:00:00')}, 'Signal': {0: 1.9048968112034605, 1: -0.42967395611318193, 2: 0.6856129262199164, 3: 3.0251231243596757, 4: 4.401208611312959}}
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_TEMPORAL_HORIZONS_FIRST_RESAMPLED_DATA 2W {'TH_2W_start': {0: Timestamp('2001-01-28 00:00:00'), 1: Timestamp('2001-02-11 00:00:00'), 2: Timestamp('2001-02-25 00:00:00'), 3: Timestamp('2001-03-11 00:00:00'), 4: Timestamp('2001-03-25 00:00:00')}, 'Signal': {0: 1.9048968112034605, 1: 0.2559389701067345, 2: 7.426331735672635, 3: 13.535884056849122, 4: 16.03047951939704}}
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_TEMPORAL_HORIZONS_FIRST_RESAMPLED_DATA M {'TH_M_start': {0: Timestamp('2001-01-28 00:00:00'), 1: Timestamp('2001-02-25 00:00:00'), 2: Timestamp('2001-03-28 00:00:00'), 3: Timestamp('2001-04-27 00:00:00'), 4: Timestamp('2001-05-28 00:00:00')}, 'Signal': {0: 1.9048968112034605, 1: 7.682270705779369, 2: 29.566363576246165, 3: 54.9125974828608, 4: 61.61979017711737}}
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_TEMPORAL_HORIZONS_FIRST_RESAMPLED_DATA Q {'TH_Q_start': {0: Timestamp('2001-01-28 00:00:00'), 1: Timestamp('2001-04-29 00:00:00'), 2: Timestamp('2001-07-30 00:00:00'), 3: Timestamp('2001-10-30 00:00:00'), 4: Timestamp('2002-01-28 00:00:00')}, 'Signal': {0: 39.15353109322899, 1: 172.76079184763768, 2: 101.47037417974255, 3: 135.17045147539451, 4: 187.1071220902626}}
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_TEMPORAL_HORIZONS {'W': 36, '2W': 18, 'M': 9, 'Q': 2}
INFO:pyaf.std:START_TRAINING '['Signal_W', 'Signal_2W', 'Signal_M', 'Signal_Q']'
<IPython.core.display.Image object>
INFO:pyaf.std:END_TRAINING_TIME_IN_SECONDS '['Signal_W', 'Signal_2W', 'Signal_M', 'Signal_Q']' 167.36388039588928
INFO:pyaf.hierarchical:TRAINING_HIERARCHICAL_MODEL_COMPUTE_TOP_DOWN_HISTORICAL_PROPORTIONS
INFO:pyaf.std:START_FORECASTING '['Signal_W', 'Signal_2W', 'Signal_M', 'Signal_Q']'
INFO:pyaf.std:END_FORECAST_TIME_IN_SECONDS  '['Signal_W', 'Signal_2W', 'Signal_M', 'Signal_Q']' 22.542559385299683
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_MODEL_COMBINATION_METHODS ['BU', 'TD', 'MO', 'OC']
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_MODEL_BOTTOM_UP_METHOD BU
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_MODEL_TOP_DOWN_METHOD AHP_TD
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_MODEL_TOP_DOWN_METHOD PHA_TD
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_MODEL_MIDDLE_OUT_METHOD MO
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_MODEL_OPTIMAL_COMBINATION_METHOD OC
INFO:pyaf.hierarchical:FORECASTING_HIERARCHICAL_MODEL_OPTIMAL_COMBINATION_METHOD
INFO:pyaf.hierarchical:STRUCTURE [0, 1, 2, 3]
INFO:pyaf.hierarchical:DATASET_COLUMNS Index(['TH_Q_start', 'TH_M_start', 'TH_2W_start', 'TH_W_start', 'Signal_W',
       'Signal_W_Forecast', 'Signal_W_Forecast_Lower_Bound',
       'Signal_W_Forecast_Upper_Bound', 'Signal_2W', 'Signal_2W_Forecast',
       'Signal_2W_Forecast_Lower_Bound', 'Signal_2W_Forecast_Upper_Bound',
       'Signal_M', 'Signal_M_Forecast', 'Signal_M_Forecast_Lower_Bound',
       'Signal_M_Forecast_Upper_Bound', 'Signal_Q', 'Signal_Q_Forecast',
       'Signal_Q_Forecast_Lower_Bound', 'Signal_Q_Forecast_Upper_Bound',
       'Signal_W_BU_Forecast', 'Signal_2W_BU_Forecast', 'Signal_M_BU_Forecast',
       'Signal_Q_BU_Forecast', 'Signal_Q_AHP_TD_Forecast',
       'Signal_M_AHP_TD_Forecast', 'Signal_2W_AHP_TD_Forecast',
       'Signal_W_AHP_TD_Forecast', 'Signal_Q_PHA_TD_Forecast',
       'Signal_M_PHA_TD_Forecast', 'Signal_2W_PHA_TD_Forecast',
       'Signal_W_PHA_TD_Forecast', 'Signal_M_MO_Forecast',
       'Signal_2W_MO_Forecast', 'Signal_W_MO_Forecast', 'Signal_Q_MO_Forecast',
       'Signal_W_OC_Forecast', 'Signal_2W_OC_Forecast', 'Signal_M_OC_Forecast',
       'Signal_Q_OC_Forecast'],
      dtype='object')
INFO:pyaf.hierarchical:STRUCTURE_LEVEL (0, ['Signal_W'])
INFO:pyaf.hierarchical:STRUCTURE_LEVEL (1, ['Signal_2W'])
INFO:pyaf.hierarchical:STRUCTURE_LEVEL (2, ['Signal_M'])
INFO:pyaf.hierarchical:STRUCTURE_LEVEL (3, ['Signal_Q'])
/usr/lib/python3/dist-packages/numpy/core/fromnumeric.py:3372: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/usr/lib/python3/dist-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/usr/lib/python3/dist-packages/numpy/core/_methods.py:233: RuntimeWarning: Degrees of freedom <= 0 for slice
  ret = _var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/usr/lib/python3/dist-packages/numpy/core/_methods.py:194: RuntimeWarning: invalid value encountered in true_divide
  arrmean = um.true_divide(
/usr/lib/python3/dist-packages/numpy/core/_methods.py:226: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
ERROR:pyaf.std:Failure when computing perf ['Signal_Q'] 'Signal_Q'
Traceback (most recent call last):
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/TS/Perf.py", line 80, in compute
    return self.real_compute(signal, estimator, name);
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/TS/Perf.py", line 129, in real_compute
    self.mSignalQuantiles = self.compute_signal_quantiles(signal , estimator);
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/TS/Perf.py", line 135, in compute_signal_quantiles
    Q = int(100 // NQ)
ZeroDivisionError: integer division or modulo by zero

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/antoine/dev/python/packages/timeseries/pyaf/tests/temporal_hierarchy/test_temporal_demo_weekly_W_2W_M_Q.py", line 50, in <module>
    lSignalHierarchy = lEngine.train(df_train , lDateColumn, lSignalVar, H, lHierarchy, None);
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/HierarchicalForecastEngine.py", line 25, in train
    raise error
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/HierarchicalForecastEngine.py", line 23, in train
    self.train_HierarchicalModel(iInputDS, iTime, iSignal, iHorizon, iHierarchy, iExogenousData);
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/HierarchicalForecastEngine.py", line 103, in train_HierarchicalModel
    self.mSignalHierarchy.fit();
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/TS/SignalHierarchy.py", line 213, in fit
    self.computePerfOnCombinedForecasts(lForecast_DF.head(lForecast_DF.shape[0] - self.mHorizon));
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/TS/SignalHierarchy.py", line 370, in computePerfOnCombinedForecasts
    lPerfValid = lEngine.computePerf(lFrameValid[signal], lFrameValid[str(signal) + "_Forecast"], signal)
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/ForecastEngine.py", line 63, in computePerf
    lForecastPerf.compute(actual, predicted, name);
  File "/home/antoine/dev/python/packages/timeseries/pyaf/pyaf/TS/Perf.py", line 85, in compute
    raise tsutil.Internal_PyAF_Error("Failure when computing perf ['" + self.mName + "'] '" + name + "'");
pyaf.TS.Utils.Internal_PyAF_Error: Failure when computing perf ['Signal_Q'] 'Signal_Q'
