INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signals': ['Ozone'], 'Horizons': {'Ozone': 12}}))
INFO:pyaf.timing:('OPERATION_START', ('SIGNAL_TRAINING', {'Signals': ['Ozone'], 'Transformations': [('Ozone', 'None', '_', 'T+S+R'), ('Ozone', 'None', '_', 'TS+R'), ('Ozone', 'None', '_', 'TSR'), ('Ozone', 'None', 'Diff_', 'T+S+R'), ('Ozone', 'None', 'Diff_', 'TS+R'), ('Ozone', 'None', 'Diff_', 'TSR'), ('Ozone', 'None', 'RelDiff_', 'T+S+R'), ('Ozone', 'None', 'RelDiff_', 'TS+R'), ('Ozone', 'None', 'RelDiff_', 'TSR'), ('Ozone', 'None', 'CumSum_', 'T+S+R'), ('Ozone', 'None', 'CumSum_', 'TS+R'), ('Ozone', 'None', 'CumSum_', 'TSR'), ('Ozone', 'None', 'Box_Cox_-2.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_-2.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_-2.0_', 'TSR'), ('Ozone', 'None', 'Box_Cox_-1.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_-1.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_-1.0_', 'TSR'), ('Ozone', 'None', 'Box_Cox_0.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_0.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_0.0_', 'TSR'), ('Ozone', 'None', 'Box_Cox_2.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_2.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_2.0_', 'TSR'), ('Ozone', 'None', 'Quantized_5_', 'T+S+R'), ('Ozone', 'None', 'Quantized_5_', 'TS+R'), ('Ozone', 'None', 'Quantized_5_', 'TSR'), ('Ozone', 'None', 'Quantized_10_', 'T+S+R'), ('Ozone', 'None', 'Quantized_10_', 'TS+R'), ('Ozone', 'None', 'Quantized_10_', 'TSR'), ('Ozone', 'None', 'Quantized_20_', 'T+S+R'), ('Ozone', 'None', 'Quantized_20_', 'TS+R'), ('Ozone', 'None', 'Quantized_20_', 'TSR'), ('Ozone', 'None', 'Logit_', 'T+S+R'), ('Ozone', 'None', 'Logit_', 'TS+R'), ('Ozone', 'None', 'Logit_', 'TSR'), ('Ozone', 'None', 'Fisher_', 'T+S+R'), ('Ozone', 'None', 'Fisher_', 'TS+R'), ('Ozone', 'None', 'Fisher_', 'TSR'), ('Ozone', 'None', 'Anscombe_', 'T+S+R'), ('Ozone', 'None', 'Anscombe_', 'TS+R'), ('Ozone', 'None', 'Anscombe_', 'TSR')], 'Cores': 8}))
     Month  Ozone       Time
0  1955-01    2.7 1955-01-01
1  1955-02    2.0 1955-02-01
2  1955-03    3.6 1955-03-01
3  1955-04    5.0 1955-04-01
4  1955-05    6.5 1955-05-01
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': '_Ozone', 'DecompositionType': 'T+S+R'}))
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': '_Ozone', 'DecompositionType': 'TS+R'}))
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': '_Ozone', 'DecompositionType': 'TSR'}))
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': 'Diff_Ozone', 'DecompositionType': 'TS+R'}))
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': 'Diff_Ozone', 'DecompositionType': 'T+S+R'}))
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': 'RelDiff_Ozone', 'DecompositionType': 'T+S+R'}))
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': 'Diff_Ozone', 'DecompositionType': 'TSR'}))
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': 'RelDiff_Ozone', 'DecompositionType': 'TS+R'}))
INFO:pyaf.timing:('OPERATION_END_ELAPSED', 0.179, ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': '_Ozone', 'DecompositionType': 'T+S+R'}))
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/circleci/.pyenv/versions/3.11.2/lib/python3.11/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trainer.py", line 233, in run_transform_thread
    arg.mSigDec.train(arg.mInputDS, arg.mSplit, arg.mTime, arg.mSignal, arg.mHorizon, arg.mTransformation, arg.mDecompositionType);
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trainer.py", line 163, in train
    lTrendEstimator.estimateTrend();
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trend.py", line 339, in estimateTrend
    self.estimateTrends()
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trend.py", line 322, in estimateTrends
    trend.fit();
    ^^^^^^^^^^^
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trend.py", line 79, in fit
    self.mTrendFrame[self.mOutName] = self.compute(self.mTrendFrame)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trend.py", line 154, in compute
    Y_pred.fillna(mean , inplace=True)
                  ^^^^
NameError: name 'mean' is not defined
"""
INFO:pyaf.timing:('OPERATION_START', ('TRAINING', {'Signal': 'Ozone', 'Horizon': 12, 'Transformation': 'RelDiff_Ozone', 'DecompositionType': 'TSR'}))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/circleci/project/pyaf/ForecastEngine.py", line 25, in train
    self.mSignalDecomposition.train(iInputDS, iTime, iSignal, iHorizon, iExogenousData);
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/circleci/project/pyaf/TS/SignalDecomposition.py", line 93, in train
    lTrainer.train(iInputDS, lSplits , self.mDateColumns, self.mSignals, self.mHorizons)
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trainer.py", line 274, in train
    self.train_all_transformations(iInputDS, iSplits, iTime, iSignals, iHorizon);
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/circleci/project/pyaf/TS/SignalDecomposition_Trainer.py", line 366, in train_all_transformations
    for res in pool.imap(run_transform_thread, args):
  File "/home/circleci/.pyenv/versions/3.11.2/lib/python3.11/multiprocessing/pool.py", line 873, in next
    raise value
NameError: name 'mean' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/circleci/project/tests/croston/test_ozone_croston_only_2.py", line 30, in <module>
    lEngine.train(df , b1.mTimeVar , b1.mSignalVar, H);
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/circleci/project/pyaf/ForecastEngine.py", line 30, in train
    raise tsutil.PyAF_Error("TRAIN_FAILED");
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyaf.TS.Utils.PyAF_Error: TRAIN_FAILED
INFO:pyaf.timing:('OPERATION_END_ELAPSED', 1.176, ('TRAINING', {'Signals': ['Ozone'], 'Horizons': {'Ozone': 12}}))
INFO:pyaf.timing:('OPERATION_END_ELAPSED', 1.072, ('SIGNAL_TRAINING', {'Signals': ['Ozone'], 'Transformations': [('Ozone', 'None', '_', 'T+S+R'), ('Ozone', 'None', '_', 'TS+R'), ('Ozone', 'None', '_', 'TSR'), ('Ozone', 'None', 'Diff_', 'T+S+R'), ('Ozone', 'None', 'Diff_', 'TS+R'), ('Ozone', 'None', 'Diff_', 'TSR'), ('Ozone', 'None', 'RelDiff_', 'T+S+R'), ('Ozone', 'None', 'RelDiff_', 'TS+R'), ('Ozone', 'None', 'RelDiff_', 'TSR'), ('Ozone', 'None', 'CumSum_', 'T+S+R'), ('Ozone', 'None', 'CumSum_', 'TS+R'), ('Ozone', 'None', 'CumSum_', 'TSR'), ('Ozone', 'None', 'Box_Cox_-2.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_-2.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_-2.0_', 'TSR'), ('Ozone', 'None', 'Box_Cox_-1.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_-1.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_-1.0_', 'TSR'), ('Ozone', 'None', 'Box_Cox_0.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_0.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_0.0_', 'TSR'), ('Ozone', 'None', 'Box_Cox_2.0_', 'T+S+R'), ('Ozone', 'None', 'Box_Cox_2.0_', 'TS+R'), ('Ozone', 'None', 'Box_Cox_2.0_', 'TSR'), ('Ozone', 'None', 'Quantized_5_', 'T+S+R'), ('Ozone', 'None', 'Quantized_5_', 'TS+R'), ('Ozone', 'None', 'Quantized_5_', 'TSR'), ('Ozone', 'None', 'Quantized_10_', 'T+S+R'), ('Ozone', 'None', 'Quantized_10_', 'TS+R'), ('Ozone', 'None', 'Quantized_10_', 'TSR'), ('Ozone', 'None', 'Quantized_20_', 'T+S+R'), ('Ozone', 'None', 'Quantized_20_', 'TS+R'), ('Ozone', 'None', 'Quantized_20_', 'TSR'), ('Ozone', 'None', 'Logit_', 'T+S+R'), ('Ozone', 'None', 'Logit_', 'TS+R'), ('Ozone', 'None', 'Logit_', 'TSR'), ('Ozone', 'None', 'Fisher_', 'T+S+R'), ('Ozone', 'None', 'Fisher_', 'TS+R'), ('Ozone', 'None', 'Fisher_', 'TSR'), ('Ozone', 'None', 'Anscombe_', 'T+S+R'), ('Ozone', 'None', 'Anscombe_', 'TS+R'), ('Ozone', 'None', 'Anscombe_', 'TSR')], 'Cores': 8}))
